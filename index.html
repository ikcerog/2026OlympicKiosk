<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milano Cortina 2026 Kiosk Dashboard (Responsive)</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=TASA+Explorer:wght@400..800&display=swap');
    </style>

    <style>
        :root {
            --font-primary: 'Inter', sans-serif;
            --font-heading: 'TASA Explorer', sans-serif;
            --color-gold: #FFD700;
            --color-silver: #C0C0C0;
            --color-bronze: #CD7F32;
            --color-background: #002244;
            --color-text-light: #F0F8FF;
            --color-accent: #E30613;
            --control-height: 80px;
            
            /* Base Font Sizes (using viewport units for dynamic scaling) */
            --font-size-h1: 3.5vw;
            --font-size-h2: 2.0vw;
            --font-size-base: 1.5vw;
            --font-size-lg: 1.8vw;
        }
        
        body {
            font-family: var(--font-primary);
            color: var(--color-text-light);
            margin: 0;
            padding: 0;
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        /* --- DYNAMIC BACKGROUND LAYERS --- */
        .background-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1s ease-in-out; 
            filter: blur(5px) brightness(0.7);
            z-index: -1;
        }
        
        #bg-1 { background-image: url('./img/001.jpg'); opacity: 1; }
        #bg-2 { background-image: url('./img/002.jpg'); }

        /* Foreground Gradient Overlay */
        #gradient-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 34, 68, 0.7);
            z-index: -1;
        }

        /* --- DASHBOARD ELEMENTS --- */
        #dashboard-container {
            width: 100%;
            height: calc(100% - var(--control-height)); 
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.1);
        }

        .panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 30px 50px;
            box-sizing: border-box;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .panel.active {
            opacity: 1;
            z-index: 10;
        }
        
        h1 { 
            font-family: var(--font-heading); 
            font-size: var(--font-size-h1); /* Dynamic sizing */
            margin-bottom: 5px; 
            font-weight: 800;
        }
        h2 { 
            font-family: var(--font-heading); 
            font-size: var(--font-size-h2); /* Dynamic sizing */
            border-bottom: 3px solid var(--color-accent); 
            padding-bottom: 5px; 
            margin-bottom: 20px;
            font-weight: 600;
        }

        /* Emojis/Flags in Panel Text */
        .event-list .sport::before, .flag-emoji, #spotlight .logo {
            font-size: var(--font-size-lg); 
            margin-right: 10px;
        }

        /* Panel 1: Schedule */
        .event-list {
            list-style: none;
            padding: 0;
            width: 95%;
            max-height: 80%;
            overflow-y: auto;
            text-align: left;
            font-family: var(--font-primary);
        }
        .event-list li {
            background: rgba(255, 255, 255, 0.15);
            margin-bottom: 8px;
            padding: 12px 18px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: var(--font-size-base); /* Dynamic sizing */
        }
        .event-list .time { 
            color: var(--color-gold); 
            font-weight: 700; 
            font-family: var(--font-heading); 
            font-size: var(--font-size-lg);
        }

        /* Panel 2: Medal Tally - Chart Container */
        #medal-tally-chart-container {
            width: 95%;
            height: 70vh;
            margin-top: 10px;
        }

        /* Panel 3: Spotlight */
        #spotlight .countdown {
            font-size: 8vw; /* Very large and dynamic */
            font-weight: 800;
            font-family: var(--font-heading); 
            color: var(--color-gold);
            margin-top: 20px;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        #spotlight p { font-size: var(--font-size-lg); margin-top: 10px; }

        /* KIOSK CONTROLS */
        #kiosk-controls {
            width: 100%;
            height: var(--control-height);
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px 0;
            box-sizing: border-box;
            z-index: 20;
        }
        .control-button {
            background-color: var(--color-accent);
            color: var(--color-text-light);
            border: none;
            padding: 15px 30px;
            margin: 0 10px;
            font-size: 1.2vw; /* Dynamic sizing for buttons */
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
            font-weight: 600;
            font-family: var(--font-heading);
        }
        
        /* --- MOBILE/VERTICAL SCREEN STYLING (Responsive Flow) --- */
        @media (max-width: 768px), (orientation: portrait) {
            :root {
                --font-size-h1: 7vw;
                --font-size-h2: 4.5vw;
                --font-size-base: 3.5vw;
                --font-size-lg: 4.5vw;
                --control-height: 10vh;
            }

            .panel {
                padding: 20px;
            }
            
            /* Adjust countdown size for portrait */
            #spotlight .countdown {
                font-size: 15vw;
            }
            
            /* Stack controls vertically or wrap them */
            #kiosk-controls {
                flex-wrap: wrap;
                justify-content space-around;
                padding: 5px;
            }

            .control-button {
                padding: 10px 15px;
                margin: 5px;
                font-size: 3vw;
                flex-grow: 1; /* Allow buttons to expand */
                min-width: 40%;
            }
            
            /* Ensure the chart container adapts */
            #medal-tally-chart-container {
                height: 60vh;
            }
        }
    </style>
</head>
<body>
    
    <div id="bg-1" class="background-layer"></div>
    <div id="bg-2" class="background-layer"></div>
    <div id="gradient-overlay"></div>

    <div id="dashboard-container">

        <div id="schedule" class="panel active">
            <h1>üìÖ TODAY'S SCHEDULE</h1>
            <h2>Upcoming Medal Events</h2>
            <ul class="event-list"></ul>
        </div>

        <div id="medal-tally" class="panel">
            <h1>üèÖ MEDAL STANDINGS</h1>
            <h2>Top 10 Nations (Stacked Bar Chart)</h2>
            <div id="medal-tally-chart-container">
                <canvas id="medalChart"></canvas>
            </div>
        </div>

        <div id="spotlight" class="panel">
            <div class="logo">üáÆüáπüèîÔ∏è</div>
            <h1>MILANO CORTINA 2026</h1>
            <h2>Countdown to the Games</h2>
            <div id="countdown-timer" class="countdown">-- days --</div>
            <p>February 6 ‚Äì 22, 2026</p>
        </div>

    </div>

    <div id="kiosk-controls">
        <button id="prev-button" class="control-button">‚¨ÖÔ∏è BACK</button>
        <button id="pause-button" class="control-button">‚è∏Ô∏è PAUSE</button>
        <button id="next-button" class="control-button">FORWARD ‚û°Ô∏è</button>
        <button id="speed-toggle" class="control-button">üê¢ SLOW SWAP (15s)</button>
    </div>

    <script>
        // --- 1. MOCK DATA (Unchanged) ---
        const medalData = [
            { rank: 1, country: "Norway", code: "NOR", G: 16, S: 8, B: 13, T: 37 },
            { rank: 2, country: "Germany", code: "GER", G: 12, S: 10, B: 5, T: 27 },
            { rank: 3, country: "Canada", code: "CAN", G: 4, S: 8, B: 14, T: 26 },
            { rank: 4, country: "USA", code: "USA", G: 8, S: 10, B: 7, T: 25 },
            { rank: 5, country: "Sweden", code: "SWE", G: 8, S: 5, B: 5, T: 18 },
            { rank: 6, country: "Austria", code: "AUT", G: 7, S: 7, B: 4, T: 18 },
            { rank: 7, country: "Italy", code: "ITA", G: 2, S: 7, B: 8, T: 17 },
            { rank: 8, country: "Japan", code: "JPN", G: 3, S: 6, B: 9, T: 18 },
            { rank: 9, country: "Netherlands", code: "NED", G: 8, S: 5, B: 4, T: 17 },
            { rank: 10, country: "China", code: "CHN", G: 9, S: 4, B: 2, T: 15 },
        ].sort((a, b) => b.T - a.T); 

        const scheduleData = [
            { sport: "Alpine Skiing", event: "Women's Downhill Final", time: "09:30 AM CET" },
            { sport: "Curling", event: "Men's Gold Medal Match", time: "11:00 AM CET" },
            { sport: "Biathlon", event: "Mixed 4x6km Relay", time: "01:30 PM CET" },
            { sport: "Figure Skating", event: "Ice Dance Free Skate", time: "03:00 PM CET" },
            { sport: "Speed Skating", event: "Men's 500m Final", time: "04:30 PM CET" },
            { sport: "Bobsleigh", event: "Women's Monobob Run 3", time: "06:00 PM CET" },
            { sport: "Ice Hockey", event: "Men's Group A: SWE vs FIN", time: "08:00 PM CET" }
        ];

        function getFlagEmoji(code) {
            const flags = {
                'NOR': 'üá≥üá¥', 'GER': 'üá©üá™', 'CAN': 'üá®üá¶', 'USA': 'üá∫üá∏', 'SWE': 'üá∏üá™',
                'AUT': 'üá¶üáπ', 'ITA': 'üáÆüáπ', 'JPN': 'üáØüáµ', 'NED': 'üá≥üá±', 'CHN': 'üá®üá≥'
            };
            return flags[code] || 'üö©';
        }
        
        let medalChart; 

        // --- 2. DATA RENDERING FUNCTIONS (Chart Text Color Fixed) ---

        function renderMedalTally() {
            const ctx = document.getElementById('medalChart').getContext('2d');
            
            // Function to get the current computed font size from CSS
            const getComputedFontSize = (baseVW) => {
                const vw = window.innerWidth / 100;
                return `${baseVW * vw}px`;
            };
            
            // Dynamic Font Sizing for Chart.js
            const chartFontSizeBase = getComputedFontSize(1.2); // 1.2vw
            const chartFontSizeHeading = getComputedFontSize(1.6); // 1.6vw

            const labels = medalData.map(c => `${getFlagEmoji(c.code)} ${c.country} (${c.T})`);
            const goldData = medalData.map(c => c.G);
            const silverData = medalData.map(c => c.S);
            const bronzeData = medalData.map(c => c.B);
            
            // Get CSS variable for text color
            const textColor = document.documentElement.style.getPropertyValue('--color-text-light') || '#F0F8FF';

            if (medalChart) {
                medalChart.destroy();
            }

            medalChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Bronze',
                            data: bronzeData,
                            backgroundColor: document.documentElement.style.getPropertyValue('--color-bronze') || '#CD7F32',
                            borderColor: 'var(--color-background)',
                            borderWidth: 1
                        },
                        {
                            label: 'Silver',
                            data: silverData,
                            backgroundColor: document.documentElement.style.getPropertyValue('--color-silver') || '#C0C0C0',
                            borderColor: 'var(--color-background)',
                            borderWidth: 1
                        },
                        {
                            label: 'Gold',
                            data: goldData,
                            backgroundColor: document.documentElement.style.getPropertyValue('--color-gold') || '#FFD700',
                            borderColor: 'var(--color-background)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    indexAxis: 'y', 
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: true,
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            // Set color to white text variable
                            ticks: { color: textColor, font: { size: chartFontSizeBase, family: 'var(--font-primary)' } },
                            title: { display: true, text: 'Total Medals', color: textColor, font: { size: chartFontSizeHeading, family: 'var(--font-heading)' } }
                        },
                        y: {
                            stacked: true,
                            grid: { display: false },
                            // Set color to white text variable
                            ticks: { color: textColor, font: { size: chartFontSizeBase, family: 'var(--font-primary)' } }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                // Set color to white text variable
                                color: textColor,
                                font: { size: chartFontSizeHeading, family: 'var(--font-heading)' },
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            bodyFont: { size: chartFontSizeBase, family: 'var(--font-primary)' },
                            titleFont: { size: chartFontSizeHeading, family: 'var(--font-heading)' }
                        }
                    }
                }
            });
        }
        
        function renderSchedule() {
            const list = document.querySelector('#schedule .event-list');
            list.innerHTML = '';
            scheduleData.forEach(event => {
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <span class="sport">${event.sport}: ${event.event}</span>
                    <span class="time">${event.time}</span>
                `;
                list.appendChild(listItem);
            });
        }

        function updateCountdown() {
            const targetDate = new Date("Feb 6, 2026 00:00:00 EST").getTime();
            const now = new Date().getTime();
            const distance = targetDate - now;

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            
            const countdownEl = document.getElementById("countdown-timer");

            if (distance < 0) {
                countdownEl.innerHTML = "GAMES ARE LIVE!";
            } else {
                countdownEl.innerHTML = `${days} Days to Go`;
            }
        }

        // --- 3. ROTATION LOGIC & BACKGROUND SWAP (Unchanged) ---

        const panels = document.querySelectorAll('.panel');
        const nextButton = document.getElementById('next-button');
        const prevButton = document.getElementById('prev-button');
        const pauseButton = document.getElementById('pause-button');
        const speedToggle = document.getElementById('speed-toggle');
        const bg1 = document.getElementById('bg-1');
        const bg2 = document.getElementById('bg-2');

        let currentPanelIndex = 0;
        let rotationIntervalId;
        
        const SPEED_SLOW = 15000;
        const SPEED_FAST = 5000;
        let currentRotationSpeed = SPEED_SLOW;
        let isPaused = false;
        let activeBackground = 1;

        function startRotation() {
            if (rotationIntervalId) {
                clearInterval(rotationIntervalId);
            }
            if (!isPaused) {
                rotationIntervalId = setInterval(rotatePanel, currentRotationSpeed);
            }
        }
        
        function changeBackgroundOnPanelCycle() {
            if (activeBackground === 1) {
                bg1.style.opacity = 0;
                bg2.style.opacity = 1;
                activeBackground = 2;
            } else {
                bg1.style.opacity = 1;
                bg2.style.opacity = 0;
                activeBackground = 1;
            }
        }

        function rotatePanel(direction = 1) {
            panels[currentPanelIndex].classList.remove('active');
            
            currentPanelIndex = (currentPanelIndex + direction + panels.length) % panels.length;
            
            panels[currentPanelIndex].classList.add('active');

            changeBackgroundOnPanelCycle();

            if (!isPaused) {
                startRotation(); 
            }
        }

        nextButton.addEventListener('click', () => rotatePanel(1));
        prevButton.addEventListener('click', () => rotatePanel(-1));
        
        pauseButton.addEventListener('click', () => {
            isPaused = !isPaused;
            pauseButton.textContent = isPaused ? '‚ñ∂Ô∏è PLAY' : '‚è∏Ô∏è PAUSE';
            pauseButton.style.backgroundColor = isPaused ? '#00A86B' : 'var(--color-accent)';

            if (isPaused) {
                clearInterval(rotationIntervalId);
            } else {
                startRotation();
            }
        });

        speedToggle.addEventListener('click', () => {
            if (currentRotationSpeed === SPEED_SLOW) {
                currentRotationSpeed = SPEED_FAST;
                speedToggle.textContent = 'üöÄ FAST SWAP (5s)';
                speedToggle.style.backgroundColor = '#0070c0';
            } else {
                currentRotationSpeed = SPEED_SLOW;
                speedToggle.textContent = 'üê¢ SLOW SWAP (15s)';
                speedToggle.style.backgroundColor = '#555';
            }
            if (!isPaused) {
                startRotation(); 
            }
        });


        // --- 4. INITIALIZATION ---

        function initDashboard() {
            renderSchedule();
            renderMedalTally(); 
            updateCountdown();
            startRotation();
            setInterval(updateCountdown, 1000); 
            
            // Re-render chart on window resize to ensure dynamic fonts/colors update
            window.addEventListener('resize', renderMedalTally); 
        }

        document.addEventListener('DOMContentLoaded', initDashboard);

    </script>
</body>
</html>
